# Session 1 - Foundation and Technical Skills

### Detailed Explanation of the Interview Process

The interview process in most companies typically involves multiple rounds, usually ranging from 3 to 5. Each round is designed to evaluate different aspects of a candidate's skills and suitability for the role. Below is a detailed breakdown of the typical interview process:

#### 1. Initial Round: Coding/Technical Skills
- **Format**: This round can be conducted as an online test or a live technical test.
- **Focus**: The primary aim is to assess the candidate's coding skills and technical proficiency.
- **Tech Stack**: Common technologies tested include Python, PySpark, SQL, among others.
- **Objective**: To ensure the candidate has the necessary technical skills required for the job.

#### 2. Intermediate Rounds: Blend of Technical and Management Skills
- **Number of Rounds**: Usually 1 to 3 rounds.
- **Interviewers**: As the rounds progress, candidates are interviewed by higher management.
- **Focus Areas**:
  - **Technical Skills**: Continued assessment of the candidate's technical abilities.
  - **Product/Business Understanding**: Evaluating the candidate's ability to understand the product and the business context.
  - **Role Fitment**: Determining how well the candidate fits the specific role they are being considered for.
- **Objective**: To gauge both the technical and managerial capabilities of the candidate, ensuring they can handle the responsibilities of the role.

#### 3. Final Rounds: HR and Senior Management
- **Interviewers**: These rounds are typically conducted by HR or the senior-most authority in the company.
- **Focus Areas**:
  - **Behavioral Skills**: Assessing the candidate's behavior and how they handle various situations.
  - **Communication Skills**: Evaluating the candidate's ability to communicate effectively.
  - **Intent and Values**: Understanding the candidate's motivations, values, and overall personality.
- **Objective**: To ensure the candidate aligns with the company's culture and values, and to assess their overall fit within the organization.

### Skills Assessed in Different Rounds
1. **Technical Skills**: Ability to code, problem-solving skills, familiarity with relevant technologies.
2. **Product/Business Understanding**: Ability to grasp the product's functionality and the business model.
3. **Communication Skills**: Storytelling ability, clarity in communication, and presentation skills.
4. **Behavioral Skills**: How the candidate behaves in different scenarios, teamwork, and leadership qualities.
5. **Product Management Skills**: For roles requiring product management, the ability to manage product lifecycle, prioritize features, and understand user needs.

### Summary
The interview process is designed to be comprehensive, ensuring that candidates are evaluated on a wide range of skills necessary for the role. Each round serves a specific purpose, from assessing technical abilities to understanding the candidate's fit within the company culture.

The coding round is a preliminary and eliminatory round in the hiring process, designed to assess a candidate's technical skills in areas such as Python, SQL, and PySpark. This round can be conducted on platforms like Hacker Earth, Hacker Rank, or the company's own platform, and familiarity with these platforms is advantageous.

### Format Options

The coding round can take several formats:

1. **MCQ-based**: In this format, candidates are presented with code snippets and asked to select the correct output from multiple choices. This format tests the candidate's understanding of code behavior and syntax.

2. **Coding-based**: In this format, candidates are given problems to solve by writing code from scratch. This format evaluates the candidate's ability to write functional code and solve problems efficiently.

3. **Live Coding**: Some companies may conduct live coding sessions where a candidate completes tasks while sharing their screen with a panelist. This format can be challenging as googling may not be allowed, so familiarity with basic syntax is crucial.

### Preparation

To perform well in the coding round, candidates should:

- Be prepared for various formats.
- Have a good grasp of fundamental coding concepts and syntax in the required languages.
- Practice coding exercises and problems to improve problem-solving skills.
- Familiarize themselves with the platforms used for the coding round.

### Platforms

Popular platforms used for the coding round include:

- **HackerRank**: Known for its coding challenges and technical interviews, HackerRank is widely used by companies to assess coding skills.
- **HackerEarth**: An alternative to HackerRank, HackerEarth offers a range of features such as customizable candidate details, a large question bank, and robust proctoring capabilities.

### Tips and Resources

- **Practice**: Practice coding exercises and problems to improve problem-solving skills.
- **Familiarity with platforms**: Familiarize yourself with the platforms used for the coding round.
- **Review fundamentals**: Review fundamental coding concepts and syntax in the required languages.
- **Watch tutorials and videos**: Watch tutorials and videos to improve understanding of specific technologies like PySpark and Spark SQL.
- **Use online resources**: Utilize online resources like GeeksforGeeks, which provides a comprehensive set of coding questions and practice materials for various companies and technologies.

By following these guidelines and tips, candidates can effectively prepare for the coding round and increase their chances of success.

To address the issue of fraudulent transactions and misuse on Google Pay (GPay), here's a structured approach:

### Understanding the Problem

1. **Define Fraudulent Transactions and Misuse**: Start by defining what constitutes fraudulent transactions and misuse on GPay. This could include unauthorized transactions, account takeovers, phishing attempts, etc.

2. **Impact Assessment**: Quantify the impact of these issues on GPay's users, financials, and reputation. Understand the current mitigation efforts and their effectiveness.

### Approach to Identify and Solve

#### Detection Mechanisms

1. **Data Collection and Analysis**:
   - **Transaction Data**: Gather detailed transaction logs, including timestamps, user details, and transaction amounts.
   - **User Behavior Analytics**: Utilize behavioral analytics to identify unusual patterns, such as sudden changes in transaction volume or atypical transaction locations.

2. **Machine Learning Models**:
   - **Anomaly Detection**: Implement machine learning models for anomaly detection to flag transactions that deviate from normal user behavior.
   - **Pattern Recognition**: Develop models to recognize patterns indicative of fraud, such as recurring small transactions or unusually large transactions.

#### Prevention and Mitigation Strategies

1. **Enhanced Authentication**:
   - **Two-Factor Authentication**: Implement stricter authentication measures for high-risk transactions or user behaviors.
   - **Biometric Verification**: Introduce biometric authentication options for sensitive transactions.

2. **Real-Time Monitoring and Alerts**:
   - **Alert Systems**: Set up real-time alert systems to notify users and administrators of suspicious activities.
   - **Automated Response**: Develop automated responses to block or flag suspicious transactions pending further review.

3. **User Education and Awareness**:
   - **Educational Campaigns**: Launch campaigns to educate users about common fraud tactics and how to secure their accounts.
   - **In-App Notifications**: Use push notifications within the GPay app to alert users of potential risks and provide security tips.

### Continuous Improvement

1. **Feedback Mechanism**:
   - **User Feedback**: Collect feedback from users regarding their experiences with fraud prevention measures.
   - **Data Analysis**: Use feedback data to iterate and improve fraud detection algorithms and prevention strategies.

2. **Collaboration and Partnerships**:
   - **Industry Collaboration**: Partner with financial institutions, cybersecurity firms, and regulatory bodies to share insights and best practices.
   - **Internal Cross-Functional Teams**: Establish cross-functional teams within GPay to ensure continuous improvement and innovation in fraud prevention.

### Metrics and Evaluation

1. **Key Performance Indicators (KPIs)**:
   - **Fraud Rate Reduction**: Measure the reduction in fraudulent transactions over time.
   - **User Satisfaction**: Monitor user feedback and satisfaction scores related to security and fraud prevention.

2. **Regular Audits and Reviews**:
   - **Internal Audits**: Conduct regular audits of fraud prevention measures to identify gaps and opportunities for improvement.
   - **External Reviews**: Engage third-party auditors to assess the effectiveness and robustness of GPay's security measures.

By adopting this comprehensive approach, GPay can proactively detect and mitigate fraudulent transactions and misuse, thereby safeguarding its users and enhancing trust in the platform.


Preparing for the HR round, especially in a final interview, is crucial as it focuses on assessing your alignment with the company's values and your genuine intent. Here are some tips to approach this round effectively:

1. **Research the Company**: Understand the company's values, mission statement, and current status. This knowledge will help you tailor your answers to show how your goals align with theirs.

2. **Be Authentic**: Avoid giving memorized or generic answers. Instead, reflect on your own career aspirations and how they connect with what the company offers.

3. **Show Genuine Interest**: When asked why you want to join the company, be specific. Highlight aspects such as the company culture, opportunities for growth, or alignment of your values with theirs.

4. **Discuss Long-Term and Short-Term Goals**: Have a clear idea of where you see yourself in the short term (next 1-3 years) and long term (beyond 5 years). Relate these goals to how the position and the company can help you achieve them.

5. **Address Leaving Current Company**: If asked why you are leaving your current job, focus on what you seek in terms of professional growth, new challenges, or better opportunities that the current company may not offer.

6. **Be Positive**: Even if you have had challenges in your current or past roles, frame your reasons for leaving in a positive light. Emphasize your enthusiasm for the new role rather than dissatisfaction with the old one.

7. **Ask Questions**: Demonstrate your interest by preparing thoughtful questions about the company, team dynamics, or the role itself. This shows you are invested in understanding more about where you might work.

8. **Practice Communication Skills**: Practice articulating your answers clearly and confidently. Pay attention to your body language and tone, as these also convey your sincerity.

9. **Highlight Your Skills and Experiences**: Connect your skills and experiences directly to how they will contribute to the company's goals. Showcase achievements that are relevant to the role you are applying for.

10. **Follow-Up**: After the interview, send a thank-you email expressing your appreciation for the opportunity and reiterating your interest in the position. This reinforces your enthusiasm and professionalism.

By preparing thoroughly and presenting yourself authentically, you can make a strong impression during the HR round. Remember, this round not only influences the salary negotiation but also determines your fit within the company culture and your potential for long-term success.


Preparing for key data science concepts like statistics, probability, A/B testing, and hypothesis testing is crucial for data science interviews. Here’s how you can approach each concept and what to focus on:

### Statistics Concepts

1. **Measures of Central Tendency**: Understand mean, median, and mode, and know when each is appropriate to use based on data distribution.

2. **Measures of Dispersion**: Learn about variance, standard deviation, and range to understand data spread around the mean.

3. **Correlation**: Know how to measure and interpret the strength and direction of relationships between variables using correlation coefficients.

4. **Sampling**: Understand different sampling techniques and their implications for generalizing results to larger populations.

5. **Distribution Theory**: Familiarize yourself with common probability distributions like normal, binomial, and Poisson distributions.

6. **Confidence Interval**: Know how to construct and interpret confidence intervals to estimate population parameters.

### Probability

1. **Basic Probability**: Understand concepts like conditional probability, independence, and Bayes' theorem.

2. **Probability Distributions**: Know key distributions and their properties, including discrete and continuous distributions.

### Hypothesis Testing

1. **Basic Concepts**: Understand null and alternative hypotheses, significance level (alpha), and p-values.

2. **Types of Tests**: Know when to use one-sample, two-sample, and paired t-tests, as well as chi-square tests for categorical data.

3. **Steps in Hypothesis Testing**: Be able to articulate the steps involved in hypothesis testing, from formulating hypotheses to drawing conclusions.

### A/B Testing

1. **Definition and Purpose**: Understand the purpose of A/B testing in optimizing business decisions through controlled experiments.

2. **Key Steps**: Know how to design an A/B test, including choosing metrics, determining sample size, and interpreting results.

3. **Common Pitfalls**: Be aware of common mistakes in A/B testing, such as not accounting for biases or misinterpreting results due to insufficient data.

### ANOVA (Analysis of Variance)

1. **Purpose and Applications**: Understand when to use ANOVA to compare means across multiple groups.

2. **Types of ANOVA**: Know the differences between one-way ANOVA, two-way ANOVA, and how to interpret results.

### Preparation Tips

- **Case Studies**: Practice applying these concepts to case studies or real-world scenarios. Understand the assumptions and conditions under which each statistical test is appropriate.
  
- **Mathematical Understanding**: While many tools automate statistical analysis, having a strong foundational understanding of the underlying mathematics will help you explain your findings and interpret results correctly.

- **Practical Application**: Be prepared to discuss how you’ve applied these concepts in past projects or how you would approach solving specific data problems using statistical methods.

By focusing on these concepts and their practical application, you'll be well-prepared to handle statistical questions in data science interviews effectively.

Here are detailed responses to the sample questions you provided:

1. **What are different ways of imputation? (Mean / median / mode)**

   Imputation is the process of replacing missing or corrupted data with substituted values. Common methods include:
   - **Mean imputation**: Replace missing values with the mean of the observed values for that variable.
   - **Median imputation**: Replace missing values with the median of the observed values for that variable.
   - **Mode imputation**: Replace missing values with the mode (most frequent value) of the observed values for categorical variables.

2. **Can correlation imply causation? Explain your answer.**

   Correlation measures the strength and direction of a linear relationship between two variables. However, correlation does not imply causation because:
   - **Third variables**: Correlation may be influenced by a third variable that affects both variables being studied.
   - **Direction of causation**: Correlation alone cannot determine the direction of causation (which variable is causing changes in the other).
   - **Coincidence**: Sometimes, variables may be correlated purely by chance.

   To establish causation, additional evidence from controlled experiments or rigorous observational studies is needed.

3. **What are the limitations of using correlation to measure the relationship between variables?**

   Limitations include:
   - **Non-linear relationships**: Correlation measures only linear relationships. Non-linear relationships may exist but won't be captured.
   - **Outliers**: Correlation is sensitive to outliers, which can disproportionately influence the correlation coefficient.
   - **Confounding variables**: Correlation does not account for confounding variables that may affect the relationship between the variables of interest.
   - **Causation vs. correlation**: Correlation does not imply causation, as discussed earlier.

4. **In a password with 8 characters, how many unique passwords can be created if repetition of characters is allowed?**

   For each character in the password, there are 26 possible choices (assuming lowercase English letters). Therefore, the total number of unique passwords is \( 26^8 \), which calculates to approximately 208,827,064,576 unique passwords.

5. **A company wants to survey employee satisfaction but can't survey everyone. What sampling method would ensure a representative sample of different departments?**

   **Stratified sampling** would ensure a representative sample of different departments. In this method, the population is divided into homogeneous subgroups (strata) based on a characteristic that is important to the survey (in this case, departments). Then, random samples are taken from each subgroup in proportion to their size in the population.

6. **A poll shows 60% of people support a new law, with a margin of error of +/- 3%. What is the confidence interval for the true population proportion?**

   The confidence interval can be calculated using the formula:
   \[
   \text{Confidence Interval} = \text{Sample Proportion} \pm (\text{Margin of Error})
   \]
   Here, the sample proportion is 0.60 (60%), and the margin of error is 0.03 (3%).
   \[
   \text{Confidence Interval} = 0.60 \pm 0.03 = (0.57, 0.63)
   \]
   So, the confidence interval for the true population proportion supporting the new law is approximately 57% to 63%.

7. **Tell me the difference between Simple random sampling & stratified sampling?**

   - **Simple random sampling**: Every member of the population has an equal chance of being selected into the sample, and each selection is made independently of other selections.
   - **Stratified sampling**: The population is divided into homogeneous subgroups (strata) based on a characteristic that is important to the study. Samples are then randomly selected from each stratum in proportion to the population size of the stratum.

8. **What are type 1 & Type 2 errors in hypothesis testing?**

   - **Type 1 error (False Positive)**: Rejecting a true null hypothesis. It represents the probability of incorrectly concluding there is an effect or difference when there is none. The significance level (alpha) of a test controls the probability of committing a Type 1 error.
   - **Type 2 error (False Negative)**: Failing to reject a false null hypothesis. It represents the probability of incorrectly concluding there is no effect or difference when there actually is one. It is influenced by the power of the test (1 - beta).

9. **When would you use ANOVA instead of a simple t-test to compare means?**

   - **ANOVA (Analysis of Variance)** is used to compare means between three or more groups, while a **t-test** is used to compare means between two groups.
   - Use ANOVA when you have more than two groups to compare (e.g., comparing the effectiveness of a drug across different dosages or comparing sales across multiple regions). Use a t-test when comparing two groups (e.g., comparing sales before and after a marketing campaign).

These answers should provide a comprehensive understanding of each concept and how to approach similar questions in a data science interview context.

To effectively prepare for these data science concepts, follow these structured steps:

### 1. Master the Fundamentals

- **Core Concepts**: Understand fundamental statistics concepts such as mean, median, mode, standard deviation, correlation coefficient, and basic probability rules. Relate these concepts to real-world scenarios to solidify your understanding.
  
- **Distributions**: Familiarize yourself with common probability distributions like the normal distribution (bell curve) and the binomial distribution. Understand their shapes, parameters, and typical applications.

### 2. Practice with Problems

- **Problem Solving**: Solve a variety of practice problems for each concept. This not only reinforces your theoretical knowledge but also enhances your problem-solving skills. Use online resources, textbooks, or courses that offer structured practice exercises.

- **Consistent Practice**: Allocate dedicated time each day (e.g., 30 minutes) to practice problems related to statistics and probability. This consistency helps build proficiency over time.

### 3. Visualize the Data

- **Graphical Representation**: Use tools like spreadsheets (Excel, Google Sheets) or statistical software (R, Python with libraries like matplotlib, seaborn) to visualize data. Create histograms, scatter plots, box plots, and other graphs to explore relationships and distributions.

- **Real-World Scenarios**: Link theoretical concepts with real-world data visualization examples. Understand how different types of data visualizations can reveal insights and patterns in data.

### 4. Brush Up on Statistical Tests

- **Understanding Tests**: Study commonly used statistical tests such as t-tests (one-sample, two-sample), chi-square tests (for categorical data), and ANOVA (Analysis of Variance for comparing means across multiple groups).

- **Assumptions and Application**: Learn the assumptions behind each test and when to apply them. For instance, understand when to use a t-test versus ANOVA based on the number of groups being compared.

### 5. Focus on Interpretation

- **Contextual Insight**: Don't just focus on calculating statistics; emphasize interpreting their implications. For example, understand what a high standard deviation indicates about data variability or how strong a correlation coefficient suggests a relationship between variables.

- **Communicate Findings**: Practice articulating insights derived from statistical analyses. Develop the ability to explain complex statistical concepts in a clear and understandable manner, especially in interviews or when presenting findings.

### Additional Tips

- **Use Resources**: Utilize online platforms (like Coursera, Khan Academy, or specific data science forums) that offer courses, tutorials, and community support for learning and practicing statistics.

- **Collaborate**: Engage in study groups or forums where you can discuss concepts, share problems, and learn from others' approaches to solving statistical problems.

By following these steps consistently and methodically, you can build a strong foundation in statistics and probability, preparing you well for data science interviews and practical applications in your career.


Approaching questions that require thoughtful consideration and a clear explanation is key to succeeding in the HR round or any interview where such questions might be asked. Here’s a structured approach:

1. **Understand the Question**: Take a moment to fully comprehend what is being asked. If needed, clarify any ambiguities with the interviewer to ensure you're on the same page.

2. **Think Before You Speak**: Don’t rush to answer. Take a few seconds to gather your thoughts. If necessary, jot down key points on paper or mentally organize your response before speaking.

3. **Break Down the Question**: If the question involves numbers, calculations, or assumptions, outline your approach step-by-step. Explain how you would approach the problem, the variables you would consider, and any assumptions you might need to make.

4. **Provide Context or Definitions**: For questions like "Can correlation imply causation?", begin by defining what correlation and causation mean. Discuss the relationship between them and why correlation does not necessarily imply causation. Use examples or analogies to illustrate your points.

5. **Discuss Known Information**: If you are unsure of the exact answer, discuss what you do know related to the question. For instance, if you're unfamiliar with a statistical concept, discuss related concepts you are familiar with and how they might apply.

6. **Admit When You Don’t Know**: If you truly don’t know the answer, it's better to admit it politely rather than attempt to bluff your way through. You can say something like, "I'm not familiar with that concept, but I would be interested to learn more about it." This shows humility and a willingness to learn.

7. **Frame Your Answer Clearly**: Organize your response logically. Start with an introduction or context, delve into the main points or approach you would take, and conclude with a summary or reiteration of your main points.

8. **Engage in a Discussion**: After presenting your answer, be open to a discussion or further questions from the interviewer. This demonstrates your ability to think critically and engage in meaningful dialogue.

9. **Practice Active Listening**: Pay attention to any feedback or cues from the interviewer during your response. This can help you adjust your answer or provide additional information as needed.

10. **Stay Calm and Confident**: Maintain a confident demeanor throughout the interview, even if you encounter challenging questions. Remember, the interviewer is often more interested in your thought process and how you approach problems rather than just the correct answer.

By approaching interview questions with clarity, thoughtfulness, and a structured response, you can effectively navigate even the most challenging inquiries in the HR round.


To effectively prepare for SQL concepts typically tested in interviews, focus on the following areas:

### 1. Grasp the Core Languages

- **Data Definition Language (DDL)**: Understand how to create and modify database objects such as tables (`CREATE TABLE`), alter their structure (`ALTER TABLE`), and delete objects (`DROP TABLE`).

- **Data Manipulation Language (DML)**: Master the ability to retrieve data (`SELECT`), insert new records (`INSERT INTO`), update existing records (`UPDATE`), and delete records (`DELETE FROM`).

### 2. Master Querying Techniques

- **Basic Queries**: Practice constructing SQL queries using `SELECT`, `FROM`, and `WHERE` clauses for data retrieval. Understand how to filter data based on conditions.

- **Joins**: Learn different types of joins (`INNER JOIN`, `LEFT JOIN`, `RIGHT JOIN`, `FULL JOIN`) to combine data from multiple tables based on related columns.

- **Aggregation**: Utilize `GROUP BY` with aggregate functions (`COUNT`, `SUM`, `AVG`, `MIN`, `MAX`) to summarize data grouped by specific criteria.

### 3. Explore Advanced Techniques

- **Subqueries**: Practice using subqueries within `SELECT`, `FROM`, or `WHERE` clauses to retrieve complex or aggregated data sets.

- **Ordering Results**: Use `ORDER BY` to sort query results in ascending or descending order based on specified columns.

- **Window Functions (Optional)**: Familiarize yourself with advanced SQL techniques like `LEAD`, `LAG`, `RANK`, `DENSE_RANK`, `NTILE` for performing calculations across a set of rows related to the current row.

### 4. Navigate Schemas

- **Schema Design**: Understand relational database schema design principles, including the use of primary keys, foreign keys, and normalization.

- **Relationships**: Navigate relationships between tables using foreign key constraints to maintain data integrity and enforce referential integrity.

### 5. Optimize for Efficiency

- **Query Optimization**: Learn basic optimization techniques such as creating appropriate indexes (`CREATE INDEX`) to speed up query performance and avoiding unnecessary data retrieval.

### Bonus Points

- **Views**: Understand how to create and use views (`CREATE VIEW`) for simplified data access and enhanced security.

- **Stored Procedures**: Familiarize yourself with creating stored procedures (`CREATE PROCEDURE`) for encapsulating frequently used SQL queries and improving code reusability and security.

### Preparation Tips

- **Practice**: Work through SQL problems and exercises to reinforce your understanding and improve your query-writing skills.

- **Hands-on Experience**: Use SQL in practical scenarios, such as querying real datasets or building small projects, to gain confidence and practical experience.

- **Review Documentation**: Refer to SQL documentation (e.g., MySQL, PostgreSQL, SQL Server) to understand specific syntax and features.

By focusing on these areas and practicing regularly, you'll be well-prepared to tackle SQL-related questions in interviews and handle SQL tasks effectively in data management roles.

Here are responses to the sample SQL questions you provided:

1. **Write a query to find the total number of customers from California (CA) who have placed more than 5 orders.**

   ```sql
   SELECT c.customer_id, c.customer_name, COUNT(o.order_id) AS order_count
   FROM customers c
   JOIN orders o ON c.customer_id = o.customer_id
   WHERE c.state = 'CA'
   GROUP BY c.customer_id, c.customer_name
   HAVING COUNT(o.order_id) > 5;
   ```

2. **Select the names of all employees who earn a salary above the department average.**

   ```sql
   SELECT employee_name
   FROM employees
   WHERE salary > (
       SELECT AVG(salary)
       FROM employees
       GROUP BY department_id
       HAVING department_id = employees.department_id
   );
   ```

3. **Combine data from a customers table and an orders table using a LEFT JOIN, showing all customers even if they haven't placed any orders.**

   ```sql
   SELECT c.customer_id, c.customer_name, COALESCE(COUNT(o.order_id), 0) AS order_count
   FROM customers c
   LEFT JOIN orders o ON c.customer_id = o.customer_id
   GROUP BY c.customer_id, c.customer_name;
   ```

4. **Group products by category and calculate the average price for each category.**

   ```sql
   SELECT category, AVG(price) AS avg_price
   FROM products
   GROUP BY category;
   ```

5. **Find the top 3 most popular products (by quantity sold) in the last month.**

   Assuming there is a `products` table and an `order_details` table linking to `orders`:

   ```sql
   SELECT p.product_name, SUM(od.quantity) AS total_quantity
   FROM products p
   JOIN order_details od ON p.product_id = od.product_id
   JOIN orders o ON od.order_id = o.order_id
   WHERE o.order_date >= DATE_SUB(NOW(), INTERVAL 1 MONTH)
   GROUP BY p.product_name
   ORDER BY total_quantity DESC
   LIMIT 3;
   ```

6. **Write a query to update the email addresses for all customers in the state of New York (NY) to a new domain (e.g., "@newdomain.com").**

   ```sql
   UPDATE customers
   SET email = CONCAT(SUBSTRING_INDEX(email, '@', 1), '@newdomain.com')
   WHERE state = 'NY';
   ```

7. **Delete all duplicate rows from a table (ensure you specify the duplicate identification criteria).**

   Assuming `id` is a unique identifier:

   ```sql
   DELETE FROM table_name
   WHERE id NOT IN (
       SELECT MIN(id)
       FROM table_name
       GROUP BY column1, column2, ... -- Specify columns that define duplicates
   );
   ```

8. **Write a subquery to find all orders placed on a specific date (e.g., '2024-07-11').**

   ```sql
   SELECT *
   FROM orders
   WHERE order_date = '2024-07-11';
   ```

9. **Use the ORDER BY clause to sort employees by their last name in descending order.**

   ```sql
   SELECT *
   FROM employees
   ORDER BY last_name DESC;
   ```

10. **Write a stored procedure to calculate and update the total sales for each customer each month.**

    Here’s a basic outline for the stored procedure (considering MySQL syntax):

    ```sql
    DELIMITER //

    CREATE PROCEDURE calculate_update_sales()
    BEGIN
        DECLARE done INT DEFAULT 0;
        DECLARE customer_id INT;
        DECLARE sales DECIMAL(10, 2);

        DECLARE cur CURSOR FOR
            SELECT customer_id, SUM(order_total) AS total_sales
            FROM orders
            WHERE MONTH(order_date) = MONTH(NOW()) AND YEAR(order_date) = YEAR(NOW())
            GROUP BY customer_id;

        DECLARE CONTINUE HANDLER FOR NOT FOUND SET done = 1;

        OPEN cur;

        read_loop: LOOP
            FETCH cur INTO customer_id, sales;
            IF done THEN
                LEAVE read_loop;
            END IF;

            -- Update total_sales for each customer
            UPDATE customer_sales
            SET total_sales = sales
            WHERE customer_id = customer_id AND month = MONTH(NOW()) AND year = YEAR(NOW());
        END LOOP;

        CLOSE cur;
    END //

    DELIMITER ;
    ```

These SQL queries cover a range of common scenarios and should help you practice and prepare effectively for SQL-related interview questions.